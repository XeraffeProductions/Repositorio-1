<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nueva orden - Xeraffé Productions</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
    }

    main {
      padding: 2rem;
    }

    h2 {
      margin-bottom: 1rem;
    }

    .sub-menu {
      margin-bottom: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .sub-menu button {
      padding: 0.5rem 1rem;
      border: 1px solid black;
      background-color: white;
      cursor: pointer;
      font-weight: bold;
    }

    .sub-section {
      display: none;
      margin-top: 1rem;
      border-top: 1px dashed black;
      padding-top: 1rem;
    }

    .sub-section.active {
      display: block;
    }

    .image-preview {
      margin-top: 1rem;
      max-width: 100%;
    }

    section {
      display: none;
    }

    section.active {
      display: block;
    }
  </style>
</head>
<body>

  <div id="menu-placeholder"></div>

  <main>
    <!-- Grabaciones Cortas -->
    <section id="cortas" class="active">
      <h2>Grabaciones cortas</h2>
      <div class="sub-menu">
        <button onclick="showSub('c1')">Modo básico</button>
        <button onclick="showSub('c2')">Modo avanzado</button>
        <button onclick="showSub('c3')">Ejemplo 1</button>
        <button onclick="showSub('c4')">Ejemplo 2</button>
        <button onclick="showSub('c5')">Ejemplo 3</button>
        <button onclick="showSub('c6')">Ejemplo 4</button>
        <button onclick="showSub('c7')">Ejemplo 5</button>
        <button onclick="showSub('c8')">Ejemplo 6</button>
      </div>

      <!-- Sub-secciones -->
      <div id="c1" class="sub-section"><h3>Modo básico</h3><input type="file" onchange="previewImage(event, 'p1')"><img id="p1" class="image-preview" /></div>
      <div id="c2" class="sub-section">
  <h3>Modo avanzado</h3>

  <!-- Primera imagen -->
  <input type="file" onchange="previewAndSaveImage(event, 'p2a')">
  <img id="p2a" class="image-preview" />

  <!-- Segunda imagen -->
  <input type="file" onchange="previewAndSaveImage(event, 'p2b')">
  <img id="p2b" class="image-preview" />
</div>

      <!-- Ejemplo 1 -->
<div id="c3" class="sub-section">
  <h3>
    Ejemplo 1 – StartUp School UAI – 
    <a href="https://www.instagram.com/p/DJJ95nRRR_T/" target="_blank">Ver link</a>
  </h3>
  <input type="file" onchange="previewImage(event, 'p3')">
  <img id="p3" class="image-preview" />
</div>

<!-- Ejemplo 2 -->
<div id="c4" class="sub-section">
  <h3>
    Ejemplo 2 – Barbería – 
    <a href="https://ejemplo.com/video2" target="_blank">Ver link</a>
  </h3>
  <input type="file" onchange="previewImage(event, 'p4')">
  <img id="p4" class="image-preview" />
</div>

<!-- Ejemplo 3 -->
<div id="c5" class="sub-section">
  <h3>
    Ejemplo 3 – Resumen de proceso – 
    <a href="https://ejemplo.com/video3" target="_blank">Ver link</a>
  </h3>
  <input type="file" onchange="previewImage(event, 'p5')">
  <img id="p5" class="image-preview" />
</div>

<!-- Ejemplo 4 -->
<div id="c6" class="sub-section">
  <h3>
    Ejemplo 4 – Imobiliaria – 
    <a href="https://ejemplo.com/video4" target="_blank">Ver link</a>
  </h3>
  <input type="file" onchange="previewImage(event, 'p6')">
  <img id="p6" class="image-preview" />
</div>

<!-- Ejemplo 5 -->
<div id="c7" class="sub-section">
  <h3>
    Ejemplo 5 – Videos simples (1 escena) – 
    <a href="https://ejemplo.com/video5" target="_blank">Ver link</a>
  </h3>
  <input type="file" onchange="previewImage(event, 'p7')">
  <img id="p7" class="image-preview" />
</div>

<!-- Ejemplo 6 -->
<div id="c8" class="sub-section">
  <h3>
    Ejemplo 6 – Efectos complejos – 
    <a href="https://ejemplo.com/video6" target="_blank">Ver link</a>
  </h3>
  <input type="file" onchange="previewImage(event, 'p8')">
  <img id="p8" class="image-preview" />
</div>

    </section>

    <!-- Grabaciones Largas -->
    <section id="largas">
      <h2>Grabaciones largas</h2>
      <div class="sub-menu">
        <button onclick="showSub('l1')">Ejemplo 1</button>
        <button onclick="showSub('l2')">Ejemplo 2</button>
        <button onclick="showSub('l3')">Ejemplo 3</button>
      </div>

      <div id="l1" class="sub-section">
  <h3>
    Caso normal 
    <a href="https://ejemplo.com/video5" target="_blank">Ver link</a>
  </h3>
  <input type="file" onchange="previewImage(event, 'l1p')">
  <img id="l1p" class="image-preview" />
</div>

<div id="l2" class="sub-section">
  <h3>Caso extremo leve</h3>
  <input type="file" onchange="previewImage(event, 'l2p')">
  <img id="l2p" class="image-preview" />
</div>
      <div id="l3" class="sub-section">
  <h3>Caso extremo grave</h3>
  <input type="file" onchange="previewImage(event, 'l3p')">
  <img id="l3p" class="image-preview" />
</div>
    </section>
  </main>

<script>
  function showSection(id) {
    document.querySelectorAll("main > section").forEach(s => s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
  }

  function showSub(id) {
    document.querySelectorAll(".sub-section").forEach(s => s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
  }

function previewImage(event, previewId) {
  const file = event.target.files[0];
  if (!file) return;

  compressImage(file, 800, 0.7, function(compressedDataUrl) {
    document.getElementById(previewId).src = compressedDataUrl;
    localStorage.setItem(previewId, compressedDataUrl);
  });
}


  // Recuperar TODAS las imágenes al cargar
  document.addEventListener("DOMContentLoaded", () => {
    const ids = ['p1', 'p2', 'p3', 'p4', 'p5', 'p6', 'p7', 'p8', 'l1p', 'l2p', 'l3p', 'p2a', 'p2b'];
    ids.forEach(id => {
      const data = localStorage.getItem(id);
      if (data) {
        const img = document.getElementById(id);
        if (img) img.src = data;
      }
    });

    // Mostrar sección según hash
    const hash = window.location.hash;
    if (hash === "#largas") {
      showSection("largas");
    } else {
      showSection("cortas");
    }

    // Activar sub-sección por defecto de grabaciones cortas
    if (hash === "#cortas") {
      const boton = document.querySelector('button[onclick*="c1"]');
      if (boton) boton.click();
    }

    // Cargar menú
    fetch("menu.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("menu-placeholder").innerHTML = html;
      });
  });

  // Detectar cambios en hash para navegación sin recargar
  window.addEventListener("hashchange", () => {
    const hash = window.location.hash.substring(1);
    if (hash === "largas") {
      showSection("largas");
    } else {
      showSection("cortas");
    }
  });

  function compressImage(file, maxWidth = 800, quality = 0.7, callback) {
  const reader = new FileReader();
  reader.onload = function(event) {
    const img = new Image();
    img.onload = function() {
      const canvas = document.createElement("canvas");
      const scaleFactor = maxWidth / img.width;
      canvas.width = maxWidth;
      canvas.height = img.height * scaleFactor;
      const ctx = canvas.getContext("2d");
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      const compressedDataUrl = canvas.toDataURL("image/jpeg", quality);
      callback(compressedDataUrl);
    };
    img.src = event.target.result;
  };
  reader.readAsDataURL(file);
}
</script>


</body>
</html>
